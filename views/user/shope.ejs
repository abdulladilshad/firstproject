<!DOCTYPE html>
<html lang="en">

<head>
  <title>LUXE TIME WORLD</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="author" content="TemplatesJungle">
  <meta name="keywords" content="ecommerce,fashion,store">
  <meta name="description" content="Bootstrap 5 Fashion Store HTML CSS Template">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link href="/css/vendor.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" rel="stylesheet">
  <link href="/style.css" rel="stylesheet" type="text/css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&family=Marcellus&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/styles/userShope.css">
</head>

<body class="shop-page">

  <nav class="navbar navbar-expand-lg fixed-top bg-white">
    <div class="container">
      <!-- Brand -->
      <a class="navbar-brand" href="/">
        LUXE TIME
        <span class="brand-dot"></span>
      </a>

      <!-- Mobile Toggle -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="toggler-icon"></span>
      </button>

      <!-- Navigation Content -->
      <div class="collapse navbar-collapse" id="navbarContent">
        <!-- Main Menu -->
        <ul class="navbar-nav mx-auto text-uppercase">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/shop">Shop</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/men">Men</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/women">Women</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/limited-edition">Limited Edition</a>
          </li>
        </ul>

        <!-- Right Icons -->
        <div class="nav-icons">
          <a href="/search" class="nav-icon" title="Search">
            <i class="fas fa-search"></i>
          </a>
          <a href="/wishlist" class="nav-icon" title="Wishlist">
            <i class="fas fa-heart"></i>

          </a>
          <a href="/cart" class="nav-icon" title="Cart">
            <i class="fas fa-shopping-cart"></i>

          </a>
          <a href="/account" class="nav-icon" title="Account">
            <i class="fas fa-user"></i>
          </a>
        </div>
      </div>
    </div>
  </nav>


  <section class="shop-header bg-light py-5" style="margin-top: 80px;">
    <!-- Your existing shop header content -->
  </section>

  <section class="shop-header bg-light py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-12 text-center">
          <h1 class="section-title">Select Your LUXE TIME</h1>
          <p>Explore our latest collections and find your perfect style.</p>
        </div>
      </div>
    </div>
  </section>

  <section class="shop-content py-5">
    <div class="container">
      <div class="row">
        <!-- Sidebar for filters -->
        <div class="col-md-3">
          <div class="sidebar">
            <h5 class="sidebar-title">Filters</h5>
            <div class="filter-section">
              <h6>Category</h6>
              <ul class="list-unstyled">
                <li>
                  <a href="#" class="category-filter" data-category="Men's Watch">
                    Men's Watch
                  </a>
                </li>
                <li>
                  <a href="#" class="category-filter" data-category="Women's Watch">
                    Women's Watch
                  </a>
                </li>
                <li>
                  <a href="#" class="category-filter" data-category="Limited Edition">
                    Limited Edition
                  </a>
                </li>
              </ul>
            </div>
            <div class="filter-section">
              <h6>Price Range</h6>
              <input type="range" class="form-range" id="priceRange" min="0" max="100000" step="1000" value="100000">
              <div class="d-flex justify-content-between">
                <span>₹0</span>
                <span id="maxPrice">₹100000</span>
              </div>
            </div>
            <div class="filter-section">
              <h6>Sort By</h6>
              <select class="form-select" id="sortSelect">
                <option value="">Default</option>
                <option value="price_asc">Price: Low to High</option>
                <option value="price_desc">Price: High to Low</option>
                <option value="newest">Newest First</option>
              </select>
            </div>
            <button class="btn btn-secondary mt-3" id="resetFilters">Reset Filters</button>
          </div>
        </div>

        <!-- Product Grid -->
        <div class="col-md-9">
          <div class="row">
            <% products.forEach(product=> { %>
              <div class="col-md-4 mb-4">
                <div class="product-item image-zoom-effect link-effect">
                  <div class="image-holder">
                    <a href="/product/<%= product._id %>">
                      <img src="/<%= product.imagePaths[0] %>" alt="<%= product.productName %>"
                        class="product-image img-fluid">
                    </a>
                  </div>
                  <div class="product-content">
                    <h5 class="text-uppercase fs-5 mt-3">
                      <a href="/product/<%= product._id %>">
                        <%= product.productName %>
                      </a>
                    </h5>
                    <div class="price mb-3">₹<%= product.price.toFixed(2) %>
                    </div>
                    
                    <div class="color-options mb-3">
                      <% if (product.colors && Array.isArray(product.colors) && product.colors.length> 0) { %>
                        <% let defaultColor=product.colors[0]; %> 

                          <% product.colors.forEach((color, index)=> { %>
                            <label class="color-radio">
                              <input type="radio" name="color_<%= product._id %>" value="<%= color %>"
                                <%=color===defaultColor ? 'checked' : '' %>>
                              <span class="color-label" style="background-color: <%= color %>"></span>
                            </label>
                            <% }) %>
                              <% } else { %>
                                
                                <label class="color-radio">
                                  <input type="radio" name="color_<%= product._id %>" value="default" checked>
                                  <span class="color-label" style="background-color: #000"></span>
                                </label>
                                <% } %>
                    </div>

                    
                    <div class="product-buttons">
                      <button class="btn btn-primary btn-sm" onclick="addToCart('<%= product._id %>')">
                        Add to Cart
                      </button>
                      <button class="btn btn-outline-secondary btn-sm" onclick="addToWishlist('<%= product._id %>')">
                        <i class="fas fa-heart"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <% }) %>
          </div>
          
          <div class="pagination-container mt-5">
            <% if (totalPages> 1) { %>
              <nav aria-label="Product pagination" class="d-flex justify-content-center">
                <ul class="pagination pagination-lg">
               
                  <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= currentPage - 1 %>" aria-label="Previous">
                      <span aria-hidden="true">‹</span>
                    </a>
                  </li>

                 
                  <% if (currentPage> 2) { %>
                    <li class="page-item">
                      <a class="page-link" href="?page=1">1</a>
                    </li>
                    <% if (currentPage> 3) { %>
                      <li class="page-item disabled">
                        <span class="page-link">...</span>
                      </li>
                      <% } %>
                        <% } %>

                          
                          <% for(let i=Math.max(1, currentPage - 1); i <=Math.min(totalPages, currentPage + 1); i++) {
                            %>
                            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                              <a class="page-link" href="?page=<%= i %>">
                                <%= i %>
                              </a>
                            </li>
                            <% } %>

                            
                              <% if (currentPage < totalPages - 1) { %>
                                <% if (currentPage < totalPages - 2) { %>
                                  <li class="page-item disabled">
                                    <span class="page-link">...</span>
                                  </li>
                                  <% } %>
                                    <li class="page-item">
                                      <a class="page-link" href="?page=<%= totalPages %>">
                                        <%= totalPages %>
                                      </a>
                                    </li>
                                    <% } %>

                                      
                                      <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                                        <a class="page-link" href="?page=<%= currentPage + 1 %>" aria-label="Next">
                                          <span aria-hidden="true">›</span>
                                        </a>
                                      </li>
                </ul>
              </nav>
              <% } %>
          </div>

        </div>
      </div>
    </div>
  </section>

  
  <footer id="footer" class="mt-5">
   
  </footer>

  <script src="/js/jquery.min.js"></script>
  <script src="/js/plugins.js"></script>
  <script src="/js/SmoothScroll.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script src="/js/script.min.js"></script>
  <script>
    async function addToCart(productId) {
      const selectedColor = document.querySelector(`input[name="color_${productId}"]:checked`);

      if (!selectedColor) {
        alert("Please select a color!");
        return;
      }

      const colorValue = selectedColor.value;

      try {
        const response = await fetch('/cart', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ productId, color: colorValue })
        });

        const data = await response.json();

        if (data.success) {
          alert('Item added to cart!');
          updateCartUI(data.cart);
        } else {
          alert(data.message);
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Something went wrong!');
      }
    }

    function updateCartUI(cart) {
      const cartCount = document.getElementById('cart-count');
      if (cartCount) {
        cartCount.textContent = cart.items.length;
      }
    }

    async function addToWishlist(productId) {
      const selectedColor = document.querySelector(`input[name="color_${productId}"]:checked`);

      if (!selectedColor) {
        alert("Please select a color!");
        return;
      }

      const colorValue = selectedColor.value;

      try {
        const response = await fetch('/wishlist', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ productId, color: colorValue })
        });

        const data = await response.json();

        if (data.success) {
          alert('Item added to wishlist!');
         
        } else {
          alert(data.message || 'Failed to add to wishlist');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Something went wrong!');
      }
    }
  </script>
</body>

</html>